name: Build LWPC GUI (Windows EXE)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout source
      uses: actions/checkout@v4

    - name: Extract ZIP
      run: |
        tar -xf SuperLWPC-main.zip

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: Install dependencies
      run: |
        pip install pyinstaller pyqt5 matplotlib numpy

    - name: Build EXE
      run: |
        cd SuperLWPC-main\gui
        pyinstaller `
          --windowed `
          --hidden-import=matplotlib.backends.backend_qt5agg `
          --add-data "main.ui;." `
          --add-data "Ui_InputGen.ui;." `
          main.py

    - name: Upload EXE
      uses: actions/upload-artifact@v4
      with:
        name: LWPC-GUI-EXE
        path: SuperLWPC-main\gui
